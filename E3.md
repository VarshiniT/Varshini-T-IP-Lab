```python
import pandas as pd
import matplotlib.pyplot as plt
#import plotly.express as px
import numpy as np
#import plotly
#import plotly.graph_objects as go
#from plotly.subplots import make_subplots
```


```python
import requests

# Getting Data

url_request = requests.get("https://services1.arcgis.com/0MSEUqKaxRlEPj5g/arcgis/rest/services/Coronavirus_2019_nCoV_Cases/FeatureServer/1/query?where=1%3D1&outFields=*&outSR=4326&f=json")
url_json = url_request.json()
df = pd.DataFrame(url_json['features'])
```


```python
import datetime as dt

# a. transforming data

data_list = df['attributes'].tolist()
data = pd.DataFrame(data_list)
data.set_index('OBJECTID')
data = data[['Province_State','Country_Region','Last_Update','Lat','Long_','Confirmed','Recovered','Deaths','Active']]
data.columns = ('State','Country','Last Update','Lat','Long','Confirmed','Recovered','Deaths','Active')
data['State'].fillna(value = '', inplace = True)
data

# b. cleaning data

def convert_time(t):
    t = int(t)
    return dt.datetime.fromtimestamp(t)

data = data.dropna(subset = ['Last Update'])
data['Last Update'] = data['Last Update']/1000
data['Last Update'] = data['Last Update'].apply(convert_time)
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Country</th>
      <th>Last Update</th>
      <th>Lat</th>
      <th>Long</th>
      <th>Confirmed</th>
      <th>Recovered</th>
      <th>Deaths</th>
      <th>Active</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td></td>
      <td>Afghanistan</td>
      <td>2021-12-16 15:51:13</td>
      <td>33.939110</td>
      <td>67.709953</td>
      <td>157665</td>
      <td>0</td>
      <td>7331</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>Albania</td>
      <td>2021-12-16 15:51:13</td>
      <td>41.153300</td>
      <td>20.168300</td>
      <td>204627</td>
      <td>0</td>
      <td>3152</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td>Algeria</td>
      <td>2021-12-16 15:51:13</td>
      <td>28.033900</td>
      <td>1.659600</td>
      <td>213533</td>
      <td>0</td>
      <td>6165</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td>Andorra</td>
      <td>2021-12-16 15:51:13</td>
      <td>42.506300</td>
      <td>1.521800</td>
      <td>20136</td>
      <td>0</td>
      <td>134</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td>Angola</td>
      <td>2021-12-16 15:51:13</td>
      <td>-11.202700</td>
      <td>17.873900</td>
      <td>65565</td>
      <td>0</td>
      <td>1737</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>782</th>
      <td>Ohio</td>
      <td>US</td>
      <td>2021-12-16 15:51:13</td>
      <td>40.388783</td>
      <td>-82.764915</td>
      <td>1807539</td>
      <td>0</td>
      <td>27594</td>
      <td>0</td>
    </tr>
    <tr>
      <th>783</th>
      <td>Alabama</td>
      <td>US</td>
      <td>2021-12-16 15:51:13</td>
      <td>32.318200</td>
      <td>-86.902300</td>
      <td>854876</td>
      <td>0</td>
      <td>16304</td>
      <td>0</td>
    </tr>
    <tr>
      <th>784</th>
      <td>North Carolina</td>
      <td>US</td>
      <td>2021-12-16 15:51:13</td>
      <td>35.630066</td>
      <td>-79.806419</td>
      <td>1580909</td>
      <td>0</td>
      <td>19070</td>
      <td>0</td>
    </tr>
    <tr>
      <th>785</th>
      <td>District of Columbia</td>
      <td>US</td>
      <td>2021-12-16 15:51:13</td>
      <td>38.897438</td>
      <td>-77.026817</td>
      <td>69867</td>
      <td>0</td>
      <td>1203</td>
      <td>0</td>
    </tr>
    <tr>
      <th>786</th>
      <td>Maine</td>
      <td>US</td>
      <td>2021-12-16 15:51:13</td>
      <td>44.693947</td>
      <td>-69.381927</td>
      <td>132884</td>
      <td>0</td>
      <td>1378</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>786 rows Ã— 9 columns</p>
</div>




```python
# a. Top 10 confirmed countries (Bubble plot)

top10_confirmed = pd.DataFrame(data.groupby('Country')['Confirmed'].sum().nlargest(10).sort_values(ascending = False))
fig1 = px.scatter(top10_confirmed, x = top10_confirmed.index, y = 'Confirmed', size = 'Confirmed', size_max = 120,
                color = top10_confirmed.index, title = 'Top 10 Confirmed Cases Countries')
fig1.show()
```


    ---------------------------------------------------------------------------

    NameError                                 Traceback (most recent call last)

    <ipython-input-8-627cda8fb92a> in <module>
          2 
          3 top10_confirmed = pd.DataFrame(data.groupby('Country')['Confirmed'].sum().nlargest(10).sort_values(ascending = False))
    ----> 4 fig1 = px.scatter(top10_confirmed, x = top10_confirmed.index, y = 'Confirmed', size = 'Confirmed', size_max = 120,
          5                 color = top10_confirmed.index, title = 'Top 10 Confirmed Cases Countries')
          6 fig1.show()
    

    NameError: name 'px' is not defined



```python

```
